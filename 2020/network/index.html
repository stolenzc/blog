<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>网络相关技术点 | stolen&#39;s blog</title>
<meta name="keywords" content="TCP">
<meta name="description" content="介绍一些关机计算机网络的相关知识，包括TCP、HTTP、HTTPS、WebSocket等。 TCP连接过程 状态码含义： SYN(synchronous) - 表示建立连接 ACK(acknowledgment) - 表示">
<meta name="author" content="">
<link rel="canonical" href="https://blog.stolenzc.com/2020/network/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.40573d180b208ab15c3bf0a170c2ac86aa8ccf179f96f939352198fbee79100e.css" integrity="sha256-QFc9GAsgirFcO/ChcMKshqqMzxeflvk5NSGY&#43;&#43;55EA4=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous"/>
<link rel="icon" href="https://blog.stolenzc.com/images/blog.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.stolenzc.com/images/blog2_16x16.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.stolenzc.com/images/blog2_32x32.ico">
<link rel="apple-touch-icon" href="https://blog.stolenzc.com/images/blog2_128x128.ico">
<link rel="mask-icon" href="https://blog.stolenzc.com/images/blog2_128x128.ico">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="网络相关技术点" />
<meta property="og:description" content="介绍一些关机计算机网络的相关知识，包括TCP、HTTP、HTTPS、WebSocket等。 TCP连接过程 状态码含义： SYN(synchronous) - 表示建立连接 ACK(acknowledgment) - 表示" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.stolenzc.com/2020/network/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-05-03T21:31:29+00:00" />
<meta property="article:modified_time" content="2020-05-03T21:31:29+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="网络相关技术点"/>
<meta name="twitter:description" content="介绍一些关机计算机网络的相关知识，包括TCP、HTTP、HTTPS、WebSocket等。 TCP连接过程 状态码含义： SYN(synchronous) - 表示建立连接 ACK(acknowledgment) - 表示"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://blog.stolenzc.com/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "网络相关技术点",
      "item": "https://blog.stolenzc.com/2020/network/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "网络相关技术点",
  "name": "网络相关技术点",
  "description": "介绍一些关机计算机网络的相关知识，包括TCP、HTTP、HTTPS、WebSocket等。 TCP连接过程 状态码含义： SYN(synchronous) - 表示建立连接 ACK(acknowledgment) - 表示",
  "keywords": [
    "TCP"
  ],
  "articleBody": "介绍一些关机计算机网络的相关知识，包括TCP、HTTP、HTTPS、WebSocket等。\nTCP连接过程 状态码含义：\nSYN(synchronous) - 表示建立连接 ACK(acknowledgment) - 表示响应 FIN(finish) - 表示关闭连接 RST(reset) - 表示重置 PSH(push) - 表示有Data传送 URG(urgent) - 表示紧急 Sequence Number - 顺序号码 Acknowledge Number - 确认号码 三次握手：\n主机A发送位码为syn=1，随机产生seq number=1234567的数据包到服务器，主机B由SYN=1知道，A要求建立联机。 主机B收到请求后要确认联机信息，向A发送ack number=(主机A的seq+1)，syn=1，ack=1，随机产生seq=7654321的包。 主机A收到后检查ack number是否正确，即第一次发送的seq number+1，以及位码ack是否为1，若正确，主机A会再发送ack number=(主机B的seq+1)，ack=1，主机B收到后确认seq值与ack=1则连接建立成功。 四次挥手：\n主机A发送位码为fin=1，seq number=(前面已经传送过来的数据的最后一个字节的序号加1)并发送，主机B由fin=1知道A要关闭连接。 主机B返回ack=1，ack number=(主机A的seq=1)，随机产生seq number=1234567。然后等待主机B的socket服务关闭。 主机B的socket服务关闭后，向主机A发送fin=1，ack=1，ack number=(主机A的seq=1)，seq number=(前面已经传送过来的数据的最后一个字节的序号加1)并发送。 主机A收到主机B的fin后，返回ACK=1，ack number=(最后一次发送过来的seq number加1) TCP和UDP的区别 UDP TCP 是否连接 无连接 面向连接 是否可靠 不可靠传输，不使用流量控制和拥塞控制 可靠传输，使用流量控制和拥塞控制 连接对象个数 支持一对一，一对多，多对一和多对多交互通信 只能是一对一通信 传输方式 面向报文 面向字节流 首部开销 首部开销小，仅8字节 首部最小20字节，最大60字节 适用场景 适用于实时应用（IP电话、视频会议、直播等） 适用于要求可靠传输的应用，例如问卷传输 TCP向上层提供面向连接的可靠服务，UDP向上层提供无连接不可靠服务 虽然UDP并没有TCP传输来的准确，但是也能在很多实用性要求高的地方有所作为 对数据准确性要求高，速度可以相对较慢的，可以选用TCP Socket socket是一种应用程序接口，一般指的是网络中一个连接的两端，socket中通常封装了TCP和UDP的通信方式，直接使用socket就可以进行TCP或UDP的对话。\nSOCK_STREAM - 可靠数据传输，基于TCP SOCK_DGRAM - 不可靠数据传输，基于UDP HTTP HTTP是一个基于TCP协议的超文本传输协议。\n请求体结构：\n请求行 - 请求体 - 空行 - 消息体\n1 2 3 4 5 GET / HTTP/1.1 Host: www.baidu.com Connection: keep-alive Cache-Control: max-age=0 ...... 响应体结构：\n响应头 - 响应体 - 空行 - 消息体\n1 2 3 4 5 HTTP/1.1 200 OK Bdpagetype: 2 Bdqid: 0xb6dda1710004f934 Cache-Control: private ...... HTTP 0.9 只有GET请求 服务器只能回应HTML格式的字符串 HTTP 1.0 增加了POST和HEAD请求 可以发送任何格式的内容 每次通信都必须包括头信息 状态码（status code）、多字符集支持、多部分发送（multi-part type）、权限（authorization）、缓存（cache）、内容编码（content encoding）等。 HTTP 1.1 持久连接：Connection: keep-alive 管道机制：同一个TCP连接里面，客户端可以同时发送多个请求。 Content-Length 字段：声明本次回应的数据长度。 分块传输编码：Transfer-Encoding: chunked，对不定长度的内容使用分块传输 新增了许多动词方法：PUT、PATCH、HEAD、 OPTIONS、DELETE。 新增了Host字段，用来指定服务器的域名 HTTP 2 二进制协议：将HTTP 1.1中数据头为文本，数据体为文本或二进制，改为全为二进制，统称为帧（frame）：头信息帧和数据帧。 多功：在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，而且不用按照顺序一一对应，这样就避免了\"队头堵塞\"。 数据流：将每个请求或回应的所有数据包，称为一个数据流（stream）。每个数据流都有一个独一无二的编号。数据包发送的时候，都必须标记数据流ID，用来区分它属于哪个数据流。另外还规定，客户端发出的数据流，ID一律为奇数，服务器发出的，ID为偶数。 头信息压缩：头信息使用gzip或compress压缩后再发送；另一方面，客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了。 服务器推送：允许服务器未经请求，主动向客户端发送资源，这叫做服务器推送（server push）。 参考链接：互联网协议入门（一）、互联网协议入门（二）、HTTP 协议入门\nHTTP和HTTPS HTTPS是在HTTP的基础上对传输的内容进行了加密。\nHTTPS传输就是在HTTP的传输过程上添加了ssl校验\n客户端发出请求：支持的协议版本，比如TLS 1.0版；一个客户端生成的随机数，稍后用于生成\"对话密钥\"；支持的加密方法，比如RSA公钥加密； 支持的压缩方法。\n服务器回应：确认使用的加密通信协议版本，比如TLS 1.0版本；一个服务器生成的随机数，稍后用于生成\"对话密钥\"；确认使用的加密方法，比如RSA公钥加密；服务器证书。\n客户端回应：客户端验证服务器证书有效后，向服务器发送三个信息：一个随机数。该随机数用服务器公钥加密，防止被窃听；编码改变通知，表示随后的信息都将用双方商定的加密方法和密钥发送；客户端握手结束通知，表示客户端的握手阶段已经结束。\n服务器的最后回应：将客户机发送的随机数解密后，向客户机发送两个信息：编码改变通知，表示随后的信息都将用双方商定的加密方法和密钥发送；服务器握手结束通知，表示服务器的握手阶段已经结束。\n至此，整个握手阶段全部结束。接下来，客户端与服务器进入加密通信，就完全是使用普通的HTTP协议，只不过用\"会话密钥\"加密内容。\n参考内容：SSL/TLS协议运行机制的概述\nHTTP状态码 状态码 状态码英文名称 中文描述 100 Continue 继续。客户端应继续其请求 101 Switching Protocols 切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议 状态码 状态码英文名称 中文描述 200 OK 请求成功，一般用于GET与POST请求 201 Created 已创建，成功请求并创建了新的资源 202 Accepted 已接受，已经接受请求，但未处理完成 203 Non-Authoritative Information 非授权信息。请求成功。服务器已成功处理了请求，但返回的信息可能来自另一来源。 204 No Content 无内容。服务器成功处理，但未返回内容。 205 Reset Content 重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。 206 Partial Content 部分内容，服务器成功处理了部分GET请求 状态码 状态码英文名称 中文描述 300 Multiple Choices 多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端选择 301 Moved Permanently 永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI 302 Found 临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI 303 See Other 查看其它地址。与301类似。使用GET和POST请求查看 304 Not Modified 所请求的资源未修改，服务器不会返回任何资源。客户端通过一个头信息指定日期之后修改的资源 305 Use Proxy 使用代理。所请求的资源必须通过代理访问 306 Unused 已经被废弃的HTTP状态码 307 Temporary Redirect 临时重定向。与302类似。使用GET请求重定向 状态码 状态码英文名称 中文描述 400 Bad Request 客户端请求的语法错误，服务器无法理解 401 Unauthorized 请求要求用户的身份认证 402 Payment Required 保留，将来使用 403 Forbidden 服务器理解请求客户端的请求，但是拒绝执行此请求 404 Not Found 服务器无法根据客户端的请求找到资源（网页） 405 Method Not Allowed 客户端请求中的方法被禁止 406 Not Acceptable 服务器无法根据客户端请求的内容特性完成请求 407 Proxy Authentication Required 请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权 408 Request Time-out 服务器等待客户端发送的请求时间过长，超时 409 Conflict 服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突 410 Gone 客户端请求的资源已经不存在。通常标识资源以前有现在被永久删除了 411 Length Required 服务器无法处理客户端发送的不带Content-Length的请求信息 412 Precondition Failed 客户端请求信息的先决条件错误 413 Request Entity Too Large 由于请求的实体过大，服务器无法处理，因此拒绝请求 414 Request-URI Too Large 请求的URI过长（URI通常为网址），服务器无法处理 415 Unsupported Media Type 服务器无法处理请求附带的媒体格式 416 Requested range not satisfiable 客户端请求的范围无效 417 Expectation Failed 服务器无法满足Expect的请求头信息 状态码 状态码英文名称 中文描述 500 Internal Server Error 服务器内部错误，无法完成请求 501 Not Implemented 服务器不支持请求的功能，无法完成请求 502 Bad Gateway 作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应 503 Service Unavailable 由于超载或系统维护，服务器暂时的无法处理客户端的请求 504 Gateway Time-out 充当网关或代理的服务器，未及时从远端服务器获取请求 505 HTTP Version not supported 服务器不支持请求的HTTP协议的版本，无法完成处理 参考内容：HTTP状态码\n",
  "wordCount" : "3672",
  "inLanguage": "zh",
  "datePublished": "2020-05-03T21:31:29Z",
  "dateModified": "2020-05-03T21:31:29Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.stolenzc.com/2020/network/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "stolen's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.stolenzc.com/images/blog.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.stolenzc.com" accesskey="h" title="stolen&#39;s blog (Alt + H)">
                <img src="https://blog.stolenzc.com/images/blog.png" alt="" aria-label="logo"
                    height="35">stolen&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.stolenzc.com/" title="主页">
                    <span><i class='fa fa-home'>&ensp;</i>主页</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/tags/" title="标签">
                    <span><i class='fa fa-tags'>&ensp;</i>标签</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/categories/" title="分类">
                    <span><i class='fa fa-th'>&ensp;</i>分类</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/archives/" title="归档">
                    <span><i class='fa fa-archive'>&ensp;</i>归档</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span><i class='fa fa-search'>&ensp;</i>搜索</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/about/" title="关于">
                    <span><i class='fa fa-user'>&ensp;</i>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.stolenzc.com">主页</a>&nbsp;»&nbsp;<a href="https://blog.stolenzc.com/post/">Posts</a></div>
    <h1 class="post-title">
      网络相关技术点
    </h1>
    <div class="post-meta"><span title='2020-05-03 21:31:29 +0000 UTC'>2020-05-03</span>&nbsp;·&nbsp;8 分钟&nbsp;·&nbsp;3672 字

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#tcp%e8%bf%9e%e6%8e%a5%e8%bf%87%e7%a8%8b" aria-label="TCP连接过程">TCP连接过程</a></li>
                    <li>
                        <a href="#tcp%e5%92%8cudp%e7%9a%84%e5%8c%ba%e5%88%ab" aria-label="TCP和UDP的区别">TCP和UDP的区别</a></li>
                    <li>
                        <a href="#socket" aria-label="Socket">Socket</a></li>
                    <li>
                        <a href="#http" aria-label="HTTP">HTTP</a><ul>
                            
                    <li>
                        <a href="#http-09" aria-label="HTTP 0.9">HTTP 0.9</a></li>
                    <li>
                        <a href="#http-10" aria-label="HTTP 1.0">HTTP 1.0</a></li>
                    <li>
                        <a href="#http-11" aria-label="HTTP 1.1">HTTP 1.1</a></li>
                    <li>
                        <a href="#http-2" aria-label="HTTP 2">HTTP 2</a></li></ul>
                    </li>
                    <li>
                        <a href="#http%e5%92%8chttps" aria-label="HTTP和HTTPS">HTTP和HTTPS</a></li>
                    <li>
                        <a href="#http%e7%8a%b6%e6%80%81%e7%a0%81" aria-label="HTTP状态码">HTTP状态码</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><p>介绍一些关机计算机网络的相关知识，包括TCP、HTTP、HTTPS、WebSocket等。<!-- more --></p>
<h2 id="tcp连接过程">TCP连接过程<a hidden class="anchor" aria-hidden="true" href="#tcp连接过程">#</a></h2>
<p>状态码含义：</p>
<ul>
<li>SYN(synchronous) - 表示建立连接</li>
<li>ACK(acknowledgment) - 表示响应</li>
<li>FIN(finish) - 表示关闭连接</li>
<li>RST(reset) - 表示重置</li>
<li>PSH(push) - 表示有Data传送</li>
<li>URG(urgent) - 表示紧急</li>
<li>Sequence Number - 顺序号码</li>
<li>Acknowledge Number - 确认号码</li>
</ul>
<p>三次握手：</p>
<ol>
<li>主机A发送位码为syn=1，随机产生seq number=1234567的数据包到服务器，主机B由SYN=1知道，A要求建立联机。</li>
<li>主机B收到请求后要确认联机信息，向A发送ack number=(主机A的seq+1)，syn=1，ack=1，随机产生seq=7654321的包。</li>
<li>主机A收到后检查ack number是否正确，即第一次发送的seq number+1，以及位码ack是否为1，若正确，主机A会再发送ack number=(主机B的seq+1)，ack=1，主机B收到后确认seq值与ack=1则连接建立成功。</li>
</ol>
<p>四次挥手：</p>
<ol>
<li>主机A发送位码为fin=1，seq number=(前面已经传送过来的数据的最后一个字节的序号加1)并发送，主机B由fin=1知道A要关闭连接。</li>
<li>主机B返回ack=1，ack number=(主机A的seq=1)，随机产生seq number=1234567。然后等待主机B的socket服务关闭。</li>
<li>主机B的socket服务关闭后，向主机A发送fin=1，ack=1，ack number=(主机A的seq=1)，seq number=(前面已经传送过来的数据的最后一个字节的序号加1)并发送。</li>
<li>主机A收到主机B的fin后，返回ACK=1，ack number=(最后一次发送过来的seq number加1)</li>
</ol>
<h2 id="tcp和udp的区别">TCP和UDP的区别<a hidden class="anchor" aria-hidden="true" href="#tcp和udp的区别">#</a></h2>
<table>
<thead>
<tr>
<th></th>
<th>UDP</th>
<th>TCP</th>
</tr>
</thead>
<tbody>
<tr>
<td>是否连接</td>
<td>无连接</td>
<td>面向连接</td>
</tr>
<tr>
<td>是否可靠</td>
<td>不可靠传输，不使用流量控制和拥塞控制</td>
<td>可靠传输，使用流量控制和拥塞控制</td>
</tr>
<tr>
<td>连接对象个数</td>
<td>支持一对一，一对多，多对一和多对多交互通信</td>
<td>只能是一对一通信</td>
</tr>
<tr>
<td>传输方式</td>
<td>面向报文</td>
<td>面向字节流</td>
</tr>
<tr>
<td>首部开销</td>
<td>首部开销小，仅8字节</td>
<td>首部最小20字节，最大60字节</td>
</tr>
<tr>
<td>适用场景</td>
<td>适用于实时应用（IP电话、视频会议、直播等）</td>
<td>适用于要求可靠传输的应用，例如问卷传输</td>
</tr>
</tbody>
</table>
<ul>
<li>TCP向上层提供面向连接的可靠服务，UDP向上层提供无连接不可靠服务</li>
<li>虽然UDP并没有TCP传输来的准确，但是也能在很多实用性要求高的地方有所作为</li>
<li>对数据准确性要求高，速度可以相对较慢的，可以选用TCP</li>
</ul>
<h2 id="socket">Socket<a hidden class="anchor" aria-hidden="true" href="#socket">#</a></h2>
<p>socket是一种应用程序接口，一般指的是网络中一个连接的两端，socket中通常封装了TCP和UDP的通信方式，直接使用socket就可以进行TCP或UDP的对话。</p>
<ul>
<li>SOCK_STREAM - 可靠数据传输，基于TCP</li>
<li>SOCK_DGRAM - 不可靠数据传输，基于UDP</li>
</ul>
<h2 id="http">HTTP<a hidden class="anchor" aria-hidden="true" href="#http">#</a></h2>
<p>HTTP是一个基于TCP协议的超文本传输协议。</p>
<p>请求体结构：</p>
<p>请求行 - 请求体 - 空行 - 消息体</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>GET / HTTP/1.1
</span></span><span style="display:flex;"><span>Host: www.baidu.com
</span></span><span style="display:flex;"><span>Connection: keep-alive
</span></span><span style="display:flex;"><span>Cache-Control: max-age=<span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>......
</span></span></code></pre></td></tr></table>
</div>
</div><p>响应体结构：</p>
<p>响应头 - 响应体 - 空行 - 消息体</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>HTTP/1.1 <span style="color:#ff0;font-weight:bold">200</span> OK
</span></span><span style="display:flex;"><span>Bdpagetype: <span style="color:#ff0;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>Bdqid: 0xb6dda1710004f934
</span></span><span style="display:flex;"><span>Cache-Control: private
</span></span><span style="display:flex;"><span>......
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http-09">HTTP 0.9<a hidden class="anchor" aria-hidden="true" href="#http-09">#</a></h3>
<ul>
<li>只有GET请求</li>
<li>服务器只能回应HTML格式的字符串</li>
</ul>
<h3 id="http-10">HTTP 1.0<a hidden class="anchor" aria-hidden="true" href="#http-10">#</a></h3>
<ul>
<li>增加了POST和HEAD请求</li>
<li>可以发送任何格式的内容</li>
<li>每次通信都必须包括头信息</li>
<li>状态码（status code）、多字符集支持、多部分发送（multi-part type）、权限（authorization）、缓存（cache）、内容编码（content encoding）等。</li>
</ul>
<h3 id="http-11">HTTP 1.1<a hidden class="anchor" aria-hidden="true" href="#http-11">#</a></h3>
<ul>
<li>持久连接：Connection: keep-alive</li>
<li>管道机制：同一个TCP连接里面，客户端可以同时发送多个请求。</li>
<li>Content-Length 字段：声明本次回应的数据长度。</li>
<li>分块传输编码：Transfer-Encoding: chunked，对不定长度的内容使用分块传输</li>
<li>新增了许多动词方法：<code>PUT</code>、<code>PATCH</code>、<code>HEAD</code>、 <code>OPTIONS</code>、<code>DELETE</code>。</li>
<li>新增了Host字段，用来指定服务器的域名</li>
</ul>
<h3 id="http-2">HTTP 2<a hidden class="anchor" aria-hidden="true" href="#http-2">#</a></h3>
<ul>
<li>二进制协议：将HTTP 1.1中数据头为文本，数据体为文本或二进制，改为全为二进制，统称为帧（frame）：头信息帧和数据帧。</li>
<li>多功：在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，而且不用按照顺序一一对应，这样就避免了&quot;队头堵塞&quot;。</li>
<li>数据流：将每个请求或回应的所有数据包，称为一个数据流（stream）。每个数据流都有一个独一无二的编号。数据包发送的时候，都必须标记数据流ID，用来区分它属于哪个数据流。另外还规定，客户端发出的数据流，ID一律为奇数，服务器发出的，ID为偶数。</li>
<li>头信息压缩：头信息使用<code>gzip</code>或<code>compress</code>压缩后再发送；另一方面，客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了。</li>
<li>服务器推送：允许服务器未经请求，主动向客户端发送资源，这叫做服务器推送（server push）。</li>
</ul>
<p>参考链接：<a href="http://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html">互联网协议入门（一）</a>、<a href="http://www.ruanyifeng.com/blog/2012/06/internet_protocol_suite_part_ii.html">互联网协议入门（二）</a>、<a href="http://www.ruanyifeng.com/blog/2016/08/http.html">HTTP 协议入门</a></p>
<h2 id="http和https">HTTP和HTTPS<a hidden class="anchor" aria-hidden="true" href="#http和https">#</a></h2>
<p>HTTPS是在HTTP的基础上对传输的内容进行了加密。</p>
<p>HTTPS传输就是在HTTP的传输过程上添加了ssl校验</p>
<ol>
<li>
<p><strong>客户端发出请求</strong>：支持的协议版本，比如TLS 1.0版；一个客户端生成的随机数，稍后用于生成&quot;对话密钥&quot;；支持的加密方法，比如RSA公钥加密； 支持的压缩方法。</p>
</li>
<li>
<p><strong>服务器回应</strong>：确认使用的加密通信协议版本，比如TLS 1.0版本；一个服务器生成的随机数，稍后用于生成&quot;对话密钥&quot;；确认使用的加密方法，比如RSA公钥加密；服务器证书。</p>
</li>
<li>
<p><strong>客户端回应</strong>：客户端验证服务器证书有效后，向服务器发送三个信息：一个随机数。该随机数用服务器公钥加密，防止被窃听；编码改变通知，表示随后的信息都将用双方商定的加密方法和密钥发送；客户端握手结束通知，表示客户端的握手阶段已经结束。</p>
</li>
<li>
<p><strong>服务器的最后回应</strong>：将客户机发送的随机数解密后，向客户机发送两个信息：编码改变通知，表示随后的信息都将用双方商定的加密方法和密钥发送；服务器握手结束通知，表示服务器的握手阶段已经结束。</p>
</li>
<li>
<p>至此，整个握手阶段全部结束。接下来，客户端与服务器进入加密通信，就完全是使用普通的HTTP协议，只不过用&quot;会话密钥&quot;加密内容。</p>
</li>
</ol>
<p>参考内容：<a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html">SSL/TLS协议运行机制的概述</a></p>
<h2 id="http状态码">HTTP状态码<a hidden class="anchor" aria-hidden="true" href="#http状态码">#</a></h2>
<table>
<thead>
<tr>
<th style="text-align:center">状态码</th>
<th style="text-align:left">状态码英文名称</th>
<th style="text-align:left">中文描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">100</td>
<td style="text-align:left">Continue</td>
<td style="text-align:left">继续。客户端应继续其请求</td>
</tr>
<tr>
<td style="text-align:center">101</td>
<td style="text-align:left">Switching Protocols</td>
<td style="text-align:left">切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">状态码</th>
<th style="text-align:left">状态码英文名称</th>
<th style="text-align:left">中文描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">200</td>
<td style="text-align:left">OK</td>
<td style="text-align:left">请求成功，一般用于GET与POST请求</td>
</tr>
<tr>
<td style="text-align:center">201</td>
<td style="text-align:left">Created</td>
<td style="text-align:left">已创建，成功请求并创建了新的资源</td>
</tr>
<tr>
<td style="text-align:center">202</td>
<td style="text-align:left">Accepted</td>
<td style="text-align:left">已接受，已经接受请求，但未处理完成</td>
</tr>
<tr>
<td style="text-align:center">203</td>
<td style="text-align:left">Non-Authoritative Information</td>
<td style="text-align:left">非授权信息。请求成功。服务器已成功处理了请求，但返回的信息可能来自另一来源。</td>
</tr>
<tr>
<td style="text-align:center">204</td>
<td style="text-align:left">No Content</td>
<td style="text-align:left">无内容。服务器成功处理，但未返回内容。</td>
</tr>
<tr>
<td style="text-align:center">205</td>
<td style="text-align:left">Reset Content</td>
<td style="text-align:left">重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。</td>
</tr>
<tr>
<td style="text-align:center">206</td>
<td style="text-align:left">Partial Content</td>
<td style="text-align:left">部分内容，服务器成功处理了部分GET请求</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">状态码</th>
<th style="text-align:left">状态码英文名称</th>
<th style="text-align:left">中文描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">300</td>
<td style="text-align:left">Multiple Choices</td>
<td style="text-align:left">多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端选择</td>
</tr>
<tr>
<td style="text-align:center">301</td>
<td style="text-align:left">Moved Permanently</td>
<td style="text-align:left">永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI</td>
</tr>
<tr>
<td style="text-align:center">302</td>
<td style="text-align:left">Found</td>
<td style="text-align:left">临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI</td>
</tr>
<tr>
<td style="text-align:center">303</td>
<td style="text-align:left">See Other</td>
<td style="text-align:left">查看其它地址。与301类似。使用GET和POST请求查看</td>
</tr>
<tr>
<td style="text-align:center">304</td>
<td style="text-align:left">Not Modified</td>
<td style="text-align:left">所请求的资源未修改，服务器不会返回任何资源。客户端通过一个头信息指定日期之后修改的资源</td>
</tr>
<tr>
<td style="text-align:center">305</td>
<td style="text-align:left">Use Proxy</td>
<td style="text-align:left">使用代理。所请求的资源必须通过代理访问</td>
</tr>
<tr>
<td style="text-align:center">306</td>
<td style="text-align:left">Unused</td>
<td style="text-align:left">已经被废弃的HTTP状态码</td>
</tr>
<tr>
<td style="text-align:center">307</td>
<td style="text-align:left">Temporary Redirect</td>
<td style="text-align:left">临时重定向。与302类似。使用GET请求重定向</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">状态码</th>
<th style="text-align:left">状态码英文名称</th>
<th style="text-align:left">中文描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">400</td>
<td style="text-align:left">Bad Request</td>
<td style="text-align:left">客户端请求的语法错误，服务器无法理解</td>
</tr>
<tr>
<td style="text-align:center">401</td>
<td style="text-align:left">Unauthorized</td>
<td style="text-align:left">请求要求用户的身份认证</td>
</tr>
<tr>
<td style="text-align:center">402</td>
<td style="text-align:left">Payment Required</td>
<td style="text-align:left">保留，将来使用</td>
</tr>
<tr>
<td style="text-align:center">403</td>
<td style="text-align:left">Forbidden</td>
<td style="text-align:left">服务器理解请求客户端的请求，但是拒绝执行此请求</td>
</tr>
<tr>
<td style="text-align:center">404</td>
<td style="text-align:left">Not Found</td>
<td style="text-align:left">服务器无法根据客户端的请求找到资源（网页）</td>
</tr>
<tr>
<td style="text-align:center">405</td>
<td style="text-align:left">Method Not Allowed</td>
<td style="text-align:left">客户端请求中的方法被禁止</td>
</tr>
<tr>
<td style="text-align:center">406</td>
<td style="text-align:left">Not Acceptable</td>
<td style="text-align:left">服务器无法根据客户端请求的内容特性完成请求</td>
</tr>
<tr>
<td style="text-align:center">407</td>
<td style="text-align:left">Proxy Authentication Required</td>
<td style="text-align:left">请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权</td>
</tr>
<tr>
<td style="text-align:center">408</td>
<td style="text-align:left">Request Time-out</td>
<td style="text-align:left">服务器等待客户端发送的请求时间过长，超时</td>
</tr>
<tr>
<td style="text-align:center">409</td>
<td style="text-align:left">Conflict</td>
<td style="text-align:left">服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突</td>
</tr>
<tr>
<td style="text-align:center">410</td>
<td style="text-align:left">Gone</td>
<td style="text-align:left">客户端请求的资源已经不存在。通常标识资源以前有现在被永久删除了</td>
</tr>
<tr>
<td style="text-align:center">411</td>
<td style="text-align:left">Length Required</td>
<td style="text-align:left">服务器无法处理客户端发送的不带Content-Length的请求信息</td>
</tr>
<tr>
<td style="text-align:center">412</td>
<td style="text-align:left">Precondition Failed</td>
<td style="text-align:left">客户端请求信息的先决条件错误</td>
</tr>
<tr>
<td style="text-align:center">413</td>
<td style="text-align:left">Request Entity Too Large</td>
<td style="text-align:left">由于请求的实体过大，服务器无法处理，因此拒绝请求</td>
</tr>
<tr>
<td style="text-align:center">414</td>
<td style="text-align:left">Request-URI Too Large</td>
<td style="text-align:left">请求的URI过长（URI通常为网址），服务器无法处理</td>
</tr>
<tr>
<td style="text-align:center">415</td>
<td style="text-align:left">Unsupported Media Type</td>
<td style="text-align:left">服务器无法处理请求附带的媒体格式</td>
</tr>
<tr>
<td style="text-align:center">416</td>
<td style="text-align:left">Requested range not satisfiable</td>
<td style="text-align:left">客户端请求的范围无效</td>
</tr>
<tr>
<td style="text-align:center">417</td>
<td style="text-align:left">Expectation Failed</td>
<td style="text-align:left">服务器无法满足Expect的请求头信息</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">状态码</th>
<th style="text-align:left">状态码英文名称</th>
<th style="text-align:left">中文描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">500</td>
<td style="text-align:left">Internal Server Error</td>
<td style="text-align:left">服务器内部错误，无法完成请求</td>
</tr>
<tr>
<td style="text-align:center">501</td>
<td style="text-align:left">Not Implemented</td>
<td style="text-align:left">服务器不支持请求的功能，无法完成请求</td>
</tr>
<tr>
<td style="text-align:center">502</td>
<td style="text-align:left">Bad Gateway</td>
<td style="text-align:left">作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应</td>
</tr>
<tr>
<td style="text-align:center">503</td>
<td style="text-align:left">Service Unavailable</td>
<td style="text-align:left">由于超载或系统维护，服务器暂时的无法处理客户端的请求</td>
</tr>
<tr>
<td style="text-align:center">504</td>
<td style="text-align:left">Gateway Time-out</td>
<td style="text-align:left">充当网关或代理的服务器，未及时从远端服务器获取请求</td>
</tr>
<tr>
<td style="text-align:center">505</td>
<td style="text-align:left">HTTP Version not supported</td>
<td style="text-align:left">服务器不支持请求的HTTP协议的版本，无法完成处理</td>
</tr>
</tbody>
</table>
<p>参考内容：<a href="https://www.runoob.com/http/http-status-codes.html">HTTP状态码</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.stolenzc.com/tags/tcp/">TCP</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://blog.stolenzc.com/2020/windows_cmder/">
    <span class="title">« 上一页</span>
    <br>
    <span>Windows批处理命令</span>
  </a>
  <a class="next" href="https://blog.stolenzc.com/2020/test_mysql_basic/">
    <span class="title">下一页 »</span>
    <br>
    <span>MySQL基础</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://blog.stolenzc.com">stolen&#39;s blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
