<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MySQL基础 | stolen&#39;s blog</title>
<meta name="keywords" content="MySQL">
<meta name="description" content="总结MySQL基础知识，不涉及数据库CRUD基础语法 SQL名词 DQL（Data Query Language）：数据查询语言，指Select语句，通常会">
<meta name="author" content="">
<link rel="canonical" href="https://blog.stolenzc.com/2020/test_mysql_basic/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.40573d180b208ab15c3bf0a170c2ac86aa8ccf179f96f939352198fbee79100e.css" integrity="sha256-QFc9GAsgirFcO/ChcMKshqqMzxeflvk5NSGY&#43;&#43;55EA4=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous"/>
<link rel="icon" href="https://blog.stolenzc.com/images/blog.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.stolenzc.com/images/blog2_16x16.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.stolenzc.com/images/blog2_32x32.ico">
<link rel="apple-touch-icon" href="https://blog.stolenzc.com/images/blog2_128x128.ico">
<link rel="mask-icon" href="https://blog.stolenzc.com/images/blog2_128x128.ico">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="MySQL基础" />
<meta property="og:description" content="总结MySQL基础知识，不涉及数据库CRUD基础语法 SQL名词 DQL（Data Query Language）：数据查询语言，指Select语句，通常会" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.stolenzc.com/2020/test_mysql_basic/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-05-01T15:15:50+00:00" />
<meta property="article:modified_time" content="2020-05-01T15:15:50+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MySQL基础"/>
<meta name="twitter:description" content="总结MySQL基础知识，不涉及数据库CRUD基础语法 SQL名词 DQL（Data Query Language）：数据查询语言，指Select语句，通常会"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://blog.stolenzc.com/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "MySQL基础",
      "item": "https://blog.stolenzc.com/2020/test_mysql_basic/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL基础",
  "name": "MySQL基础",
  "description": "总结MySQL基础知识，不涉及数据库CRUD基础语法 SQL名词 DQL（Data Query Language）：数据查询语言，指Select语句，通常会",
  "keywords": [
    "MySQL"
  ],
  "articleBody": "总结MySQL基础知识，不涉及数据库CRUD基础语法\nSQL名词 DQL（Data Query Language）：数据查询语言，指Select语句，通常会归类到DML中 DDL（Data Definition Language）：数据定义语言，通常指Create、Drop、Alter等对表操作的语句 DML（Data Manipulation Language）：数据操作语言，通常指Insert、Delete、Update等对数据操作的语句 DCL（Data Control Language）：数据控制语言，通常指Grant、Revoke等对数据库权限控制的语句 数据库三范式 原子性：数据不可再分 唯一性：所有数据都要和数据表中的键有完全依赖关系 冗余性：非键属性之间是完全无关的 数据完整性 实体完整性：每个实体都是独一无二的\n主键（primary key） 唯一约束 唯一索引（unique） 引用完整性（参照完整性）：关系中不允许引用不存在的实体\n外键（foreign key） 域完整性：数据是有效的\n数据类型及长度 非空约束（not null） 默认值约束（default） 检查约束（check） 说明：在MySQL数据库中，检查约束并不起作用。\n数据一致性 实现原理：事务\n数据库相关的命令 普通命令 SHOW ENGINES; - 查看数据库支持的数据引擎\nbegin/start transaction - 开启事务\ncommit/rollback - 提交/回滚\nexplain sql语句 - 查看执行计划\nsavepoint 保存点名称 - 在事务中添加保存点\nrollback [work] to [savepoint] 保存点名称 - 事务中回滚到保存点\nrelease savepoint 保存点名称 - 删除保存点\n变量命令 注意：变量的查看可以通过show variables like '%变量名%'，也可以通过select @@变量名，非特殊情况不做说明\nshow global variables; - 查看所有全局变量\nshow variables; - 查看局部变量\nshow variables like '%storage_engine%'; - 查看数据库的默认引擎，此处storage_engine不是完整的变量名\nshow variables like '%datadir%'; - 查看当前数据保存位置\nshow variables like \"innodb_page_size\"; - 查看innodb一个数据页的大小\nset session autocommit = on/off - 设定事务是否自动开启\nselect @@tx_isolation; - 查看数据库的事务隔离级别（8.0.3之前版本）\nselect @@transaction_isolation; - 查看数据库的事务隔离级别（8.0.3之后版本）\nset session transaction isolation level 事务隔离名称 - 设置事务隔离级别\nMySQL数据引擎 特性 InnoDB MRG_MYISAM MEMORY MyISAM 存储限制 有 没有 有 有 事务、集群索引、外键 支持 锁机制 行锁 表锁 表锁 表锁 B树索引、索引缓存 支持 支持 支持 支持 哈希索引 支持 全文检索 支持（5.6+） 支持 数据缓存 支持 支持 数据可压缩 支持 内存使用 高 低 中 低 存储空间使用 高 低 低 批量插入性能 低 高 高 高 MySQL从5.5开始默认使用InnoDB，InnoDB也是唯一一个支持外键、事务、行锁的数据引擎。\nInnoDB 支持事务安全表（ACID）\nA（Atomicity）：原子性；事务，要么全成功，要么全失败 C（Consistency）：一致性；事务前后数据的完整性必须保持一致。 I（Isolation）：隔离性；多个事务之间相互隔离 D（Durability）：持久性；持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的 事务特性的实现\n隔离性：读写锁 + MVCC 事务隔离级别：\n无事务隔离级别：会出现第一类丢失更新、脏读、不可重复读、第二类丢失更新和幻读 Read uncommitter（未提交读）：会出现脏读、不可重复读、第二类丢失更新、幻读，解决了第一类丢失更新 Read Committer（提交读）：会出现不可重复读、第二类丢失更新、幻读，解决了脏读和第一类丢失更新 Repeatable Read（可重复读）：会出现幻读，解决了脏读、不可重复读和第二类丢失更新，MySQL默认的级别，InnoDB引擎下该级别也解决了幻读 Serializable（串行化）：最安全，速度最慢，所有问题都解决了 备注：\n第一类丢失更新：撤销一个事务的时候，把其他事务已提交的更新覆盖了 脏读：一个事务修改了数据未提交，另一个事务读到了修改后的数据 不可重复读：第一个事务读取了数据后，第二个事务修改了该数据，第一个事务再次读该数据就会读到和第一次不同是数据 第二类丢失更新：一个事务提交更新的时候，将其他事务已提交的事务覆盖了，是不可重复读的特例 幻读：事务一操作了数据库的多条记录，事务二向数据库中插入一条满足事务一操作的数据。事务一中就会发现这条满足条件的数据。像是出现幻觉一样 第一类丢失更新 脏读 第二类丢失更新 不可重复读 幻读 Read uncommitted ✅ ❌ ❌ ❌ ❌ Read Committed ✅ ✅ ❌ ❌ ❌ Repeatable Read ✅ ✅ ✅ ✅ ❌ Serializable ✅ ✅ ✅ ✅ ✅ 索引 MySQL中，所有数据类型的列都可以被索引，常用的存储引擎InnoDB和MyISAM能支持每个表创建16个索引。InnoDB和MyISAM使用的索引其底层算法是B-tree（B树），B-tree是一种自平衡的树，类似于平衡二叉排序树，能够保持数据有序。这种数据结构能够让查找数据、顺序访问、插入数据及删除的操作都在对数时间内完成。\nB-tree：是一颗多路平衡查找树；\n每个节点最多有m-1个关键字。 根节点最少可以只有1个关键字。 非根节点至少有m/2个关键字。 每个节点中的关键字都按照从小到大的顺序排列，每个关键字的左子树中的所有关键字都小于它，而右子树中的所有关键字都大于它。 所有叶子节点都位于同一层，或者说根节点到每个叶子节点的长度都相同。 每个节点都存有索引和数据，也就是对应的key和value。 B+tree：\n根节点至少一个元素。 非根节点元素范围：m/2 \u003c= k \u003c= m-1。 B+树有两种类型的节点：内部结点（也称索引结点）和叶子结点。内部节点就是非叶子节点，内部节点不存储数据，只存储索引，数据都存储在叶子节点。 内部结点中的key都按照从小到大的顺序排列，对于内部结点中的一个key，左树中的所有key都小于它，右子树中的key都大于等于它。叶子结点中的记录也按照key的大小排列。 每个叶子结点都存有相邻叶子结点的指针，叶子结点本身依关键字的大小自小而大顺序链接。 父节点存有右孩子的第一个元素的索引。 参考链接：面试官问你B树和B+树，就把这篇文章丢给他\n",
  "wordCount" : "2330",
  "inLanguage": "zh",
  "datePublished": "2020-05-01T15:15:50Z",
  "dateModified": "2020-05-01T15:15:50Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.stolenzc.com/2020/test_mysql_basic/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "stolen's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.stolenzc.com/images/blog.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.stolenzc.com" accesskey="h" title="stolen&#39;s blog (Alt + H)">
                <img src="https://blog.stolenzc.com/images/blog.png" alt="" aria-label="logo"
                    height="35">stolen&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.stolenzc.com/tags/" title="标签">
                    <span><i class='fa fa-tags'></i>标签</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/categories/" title="分类">
                    <span><i class='fa fa-th'></i>分类</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/archives/" title="归档">
                    <span><i class='fa fa-archive'></i>归档</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span><i class='fa fa-search'></i>搜索</span>
                </a>
            </li>
            <li>
                <a href="https://blog.stolenzc.com/about/" title="关于">
                    <span><i class='fa fa-user'></i>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.stolenzc.com">主页</a>&nbsp;»&nbsp;<a href="https://blog.stolenzc.com/post/">Posts</a></div>
    <h1 class="post-title">
      MySQL基础
    </h1>
    <div class="post-meta"><span title='2020-05-01 15:15:50 +0000 UTC'>2020-05-01</span>&nbsp;·&nbsp;5 分钟&nbsp;·&nbsp;2330 字

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#sql%e5%90%8d%e8%af%8d" aria-label="SQL名词">SQL名词</a><ul>
                            
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e5%ba%93%e4%b8%89%e8%8c%83%e5%bc%8f" aria-label="数据库三范式">数据库三范式</a></li>
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e5%ae%8c%e6%95%b4%e6%80%a7" aria-label="数据完整性">数据完整性</a></li>
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e4%b8%80%e8%87%b4%e6%80%a7" aria-label="数据一致性">数据一致性</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e5%ba%93%e7%9b%b8%e5%85%b3%e7%9a%84%e5%91%bd%e4%bb%a4" aria-label="数据库相关的命令">数据库相关的命令</a><ul>
                            
                    <li>
                        <a href="#%e6%99%ae%e9%80%9a%e5%91%bd%e4%bb%a4" aria-label="普通命令">普通命令</a></li>
                    <li>
                        <a href="#%e5%8f%98%e9%87%8f%e5%91%bd%e4%bb%a4" aria-label="变量命令">变量命令</a></li></ul>
                    </li>
                    <li>
                        <a href="#mysql%e6%95%b0%e6%8d%ae%e5%bc%95%e6%93%8e" aria-label="MySQL数据引擎">MySQL数据引擎</a><ul>
                            
                    <li>
                        <a href="#innodb" aria-label="InnoDB">InnoDB</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%b4%a2%e5%bc%95" aria-label="索引">索引</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><p>总结MySQL基础知识，不涉及数据库CRUD基础语法<!-- more --></p>
<h2 id="sql名词">SQL名词<a hidden class="anchor" aria-hidden="true" href="#sql名词">#</a></h2>
<ul>
<li>DQL（Data Query Language）：数据查询语言，指Select语句，通常会归类到DML中</li>
<li>DDL（Data Definition Language）：数据定义语言，通常指Create、Drop、Alter等对表操作的语句</li>
<li>DML（Data Manipulation Language）：数据操作语言，通常指Insert、Delete、Update等对数据操作的语句</li>
<li>DCL（Data Control Language）：数据控制语言，通常指Grant、Revoke等对数据库权限控制的语句</li>
</ul>
<h3 id="数据库三范式">数据库三范式<a hidden class="anchor" aria-hidden="true" href="#数据库三范式">#</a></h3>
<ol>
<li>原子性：数据不可再分</li>
<li>唯一性：所有数据都要和数据表中的键有完全依赖关系</li>
<li>冗余性：非键属性之间是完全无关的</li>
</ol>
<h3 id="数据完整性">数据完整性<a hidden class="anchor" aria-hidden="true" href="#数据完整性">#</a></h3>
<ol>
<li>
<p>实体完整性：每个实体都是独一无二的</p>
<ul>
<li>主键（primary key）</li>
<li>唯一约束</li>
<li>唯一索引（unique）</li>
</ul>
</li>
<li>
<p>引用完整性（参照完整性）：关系中不允许引用不存在的实体</p>
<ul>
<li>外键（foreign key）</li>
</ul>
</li>
<li>
<p>域完整性：数据是有效的</p>
<ul>
<li>数据类型及长度</li>
<li>非空约束（not null）</li>
<li>默认值约束（default）</li>
<li>检查约束（check）
<blockquote>
<p>说明：在MySQL数据库中，检查约束并不起作用。</p>
</blockquote>
</li>
</ul>
</li>
</ol>
<h3 id="数据一致性">数据一致性<a hidden class="anchor" aria-hidden="true" href="#数据一致性">#</a></h3>
<p>实现原理：事务</p>
<h2 id="数据库相关的命令">数据库相关的命令<a hidden class="anchor" aria-hidden="true" href="#数据库相关的命令">#</a></h2>
<h3 id="普通命令">普通命令<a hidden class="anchor" aria-hidden="true" href="#普通命令">#</a></h3>
<p><code>SHOW ENGINES;</code> - 查看数据库支持的数据引擎</p>
<p><code>begin/start transaction</code> - 开启事务</p>
<p><code>commit/rollback</code> - 提交/回滚</p>
<p><code>explain sql语句</code> - 查看执行计划</p>
<p><code>savepoint 保存点名称</code> - 在事务中添加保存点</p>
<p><code>rollback [work] to [savepoint] 保存点名称</code> - 事务中回滚到保存点</p>
<p><code>release savepoint 保存点名称</code> - 删除保存点</p>
<h3 id="变量命令">变量命令<a hidden class="anchor" aria-hidden="true" href="#变量命令">#</a></h3>
<p>注意：变量的查看可以通过<code>show variables like '%变量名%'</code>，也可以通过<code>select @@变量名</code>，非特殊情况不做说明</p>
<p><code>show global variables;</code> - 查看所有全局变量</p>
<p><code>show variables;</code> - 查看局部变量</p>
<p><code>show variables like '%storage_engine%';</code> - 查看数据库的默认引擎，此处storage_engine不是完整的变量名</p>
<p><code>show variables like '%datadir%';</code> - 查看当前数据保存位置</p>
<p><code>show variables like &quot;innodb_page_size&quot;;</code> - 查看innodb一个数据页的大小</p>
<p><code>set session autocommit = on/off</code> - 设定事务是否自动开启</p>
<p><code>select @@tx_isolation;</code> - 查看数据库的事务隔离级别（8.0.3之前版本）</p>
<p><code>select @@transaction_isolation;</code> - 查看数据库的事务隔离级别（8.0.3之后版本）</p>
<p><code>set session transaction isolation level 事务隔离名称</code> - 设置事务隔离级别</p>
<h2 id="mysql数据引擎">MySQL数据引擎<a hidden class="anchor" aria-hidden="true" href="#mysql数据引擎">#</a></h2>
<table>
<thead>
<tr>
<th>特性</th>
<th>InnoDB</th>
<th>MRG_MYISAM</th>
<th>MEMORY</th>
<th>MyISAM</th>
</tr>
</thead>
<tbody>
<tr>
<td>存储限制</td>
<td>有</td>
<td>没有</td>
<td>有</td>
<td>有</td>
</tr>
<tr>
<td>事务、集群索引、外键</td>
<td>支持</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>锁机制</td>
<td>行锁</td>
<td>表锁</td>
<td>表锁</td>
<td>表锁</td>
</tr>
<tr>
<td>B树索引、索引缓存</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>哈希索引</td>
<td></td>
<td></td>
<td>支持</td>
<td></td>
</tr>
<tr>
<td>全文检索</td>
<td>支持（5.6+）</td>
<td></td>
<td></td>
<td>支持</td>
</tr>
<tr>
<td>数据缓存</td>
<td>支持</td>
<td></td>
<td>支持</td>
<td></td>
</tr>
<tr>
<td>数据可压缩</td>
<td></td>
<td></td>
<td></td>
<td>支持</td>
</tr>
<tr>
<td>内存使用</td>
<td>高</td>
<td>低</td>
<td>中</td>
<td>低</td>
</tr>
<tr>
<td>存储空间使用</td>
<td>高</td>
<td>低</td>
<td></td>
<td>低</td>
</tr>
<tr>
<td>批量插入性能</td>
<td>低</td>
<td>高</td>
<td>高</td>
<td>高</td>
</tr>
</tbody>
</table>
<p>MySQL从5.5开始默认使用InnoDB，InnoDB也是唯一一个支持<strong>外键、事务、行锁</strong>的数据引擎。</p>
<h3 id="innodb">InnoDB<a hidden class="anchor" aria-hidden="true" href="#innodb">#</a></h3>
<p>支持事务安全表（ACID）</p>
<ul>
<li>A（Atomicity）：原子性；事务，要么全成功，要么全失败</li>
<li>C（Consistency）：一致性；事务前后数据的完整性必须保持一致。</li>
<li>I（Isolation）：隔离性；多个事务之间相互隔离</li>
<li>D（Durability）：持久性；持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的</li>
</ul>
<p>事务特性的实现</p>
<ul>
<li>隔离性：读写锁 + MVCC</li>
</ul>
<p>事务隔离级别：</p>
<ul>
<li>无事务隔离级别：会出现第一类丢失更新、脏读、不可重复读、第二类丢失更新和幻读</li>
<li>Read uncommitter（未提交读）：会出现脏读、不可重复读、第二类丢失更新、幻读，解决了第一类丢失更新</li>
<li>Read Committer（提交读）：会出现不可重复读、第二类丢失更新、幻读，解决了脏读和第一类丢失更新</li>
<li>Repeatable Read（可重复读）：会出现幻读，解决了脏读、不可重复读和第二类丢失更新，MySQL默认的级别，InnoDB引擎下该级别也解决了幻读</li>
<li>Serializable（串行化）：最安全，速度最慢，所有问题都解决了</li>
</ul>
<p>备注：</p>
<ul>
<li>第一类丢失更新：撤销一个事务的时候，把其他事务已提交的更新覆盖了</li>
<li>脏读：一个事务修改了数据未提交，另一个事务读到了修改后的数据</li>
<li>不可重复读：第一个事务读取了数据后，第二个事务修改了该数据，第一个事务再次读该数据就会读到和第一次不同是数据</li>
<li>第二类丢失更新：一个事务提交更新的时候，将其他事务已提交的事务覆盖了，是不可重复读的特例</li>
<li>幻读：事务一操作了数据库的多条记录，事务二向数据库中插入一条满足事务一操作的数据。事务一中就会发现这条满足条件的数据。像是出现幻觉一样</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">第一类丢失更新</th>
<th style="text-align:center">脏读</th>
<th style="text-align:center">第二类丢失更新</th>
<th style="text-align:center">不可重复读</th>
<th style="text-align:center">幻读</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Read uncommitted</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">❌</td>
<td style="text-align:center">❌</td>
<td style="text-align:center">❌</td>
<td style="text-align:center">❌</td>
</tr>
<tr>
<td style="text-align:center">Read Committed</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">❌</td>
<td style="text-align:center">❌</td>
<td style="text-align:center">❌</td>
</tr>
<tr>
<td style="text-align:center">Repeatable Read</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">❌</td>
</tr>
<tr>
<td style="text-align:center">Serializable</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">✅</td>
<td style="text-align:center">✅</td>
</tr>
</tbody>
</table>
<h2 id="索引">索引<a hidden class="anchor" aria-hidden="true" href="#索引">#</a></h2>
<p>MySQL中，所有数据类型的列都可以被索引，常用的存储引擎InnoDB和MyISAM能支持每个表创建16个索引。InnoDB和MyISAM使用的索引其底层算法是B-tree（B树），B-tree是一种自平衡的树，类似于平衡二叉排序树，能够保持数据有序。这种数据结构能够让查找数据、顺序访问、插入数据及删除的操作都在对数时间内完成。</p>
<p>B-tree：是一颗多路平衡查找树；</p>
<ul>
<li>每个节点最多有m-1个关键字。</li>
<li>根节点最少可以只有1个关键字。</li>
<li>非根节点至少有m/2个关键字。</li>
<li>每个节点中的关键字都按照从小到大的顺序排列，每个关键字的左子树中的所有关键字都小于它，而右子树中的所有关键字都大于它。</li>
<li>所有叶子节点都位于同一层，或者说根节点到每个叶子节点的长度都相同。</li>
<li>每个节点都存有索引和数据，也就是对应的key和value。</li>
</ul>
<p>B+tree：</p>
<ul>
<li>根节点至少一个元素。</li>
<li>非根节点元素范围：m/2 &lt;= k &lt;= m-1。</li>
<li>B+树有两种类型的节点：内部结点（也称索引结点）和叶子结点。内部节点就是非叶子节点，内部节点不存储数据，只存储索引，数据都存储在叶子节点。</li>
<li>内部结点中的key都按照从小到大的顺序排列，对于内部结点中的一个key，左树中的所有key都小于它，右子树中的key都大于等于它。叶子结点中的记录也按照key的大小排列。</li>
<li>每个叶子结点都存有相邻叶子结点的指针，叶子结点本身依关键字的大小自小而大顺序链接。</li>
<li>父节点存有右孩子的第一个元素的索引。</li>
</ul>
<p>参考链接：<a href="https://segmentfault.com/a/1190000020416577">面试官问你B树和B+树，就把这篇文章丢给他</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.stolenzc.com/tags/mysql/">MySQL</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://blog.stolenzc.com/2020/network/">
    <span class="title">« 上一页</span>
    <br>
    <span>网络相关技术点</span>
  </a>
  <a class="next" href="https://blog.stolenzc.com/2020/edge/">
    <span class="title">下一页 »</span>
    <br>
    <span>Edge上手</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://blog.stolenzc.com">stolen&#39;s blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
